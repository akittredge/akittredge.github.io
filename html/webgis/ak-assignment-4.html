<!DOCTYPE html>

<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<link rel="stylesheet" href="//code.jquery.com/ui/1.13.1/themes/base/jquery-ui.css">

	<script src="https://code.jquery.com/jquery-3.6.0.js"></script>
	<script src="https://code.jquery.com/ui/1.13.1/jquery-ui.js"></script>

    <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css"
    integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
    crossorigin=""
    />
    <script
    src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"
    integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew=="
    crossorigin=""
    ></script>

    
	<style>
		
		body {
			height: 100%;
			width: 100%;
			padding: 0;
			margin: 0;
			border: 0;
			background-attachment: fixed;
			background-size: 100% auto;
		}

		.blended_grid {
			display: block;
			width: 100%;
			height: 100%;
			overflow: auto;
			margin: 0px auto 0 auto;
		}

		.pageHeader {
			display: flex;
            justify-content: space-around;
            align-items: center;
            background-color: #eff3ff;
			float: left;
			clear: none;
			height: 100px;
			width: 100%;
            font-family:sans-serif;
            font-weight: bold;
		}

		.pageLeftMenu {
			background-color: #eff3ff;
			float: left;
			clear: none;
			height: 800px;
			width: 5%;
		}

		.pageContent {
			background-color: rgba(0, 0, 0, 0.5);
			float: left;
			clear: none;
			height: 800px;
			width: 90%;
		}

		.pageRightMenu {
			background-color: #eff3ff;
			float: right;
			clear: none;
			overflow: auto;
			height: 800px;
			width: 5%;
			left:0 !important;
			
		}

		.pageFooter {
			background-color: #eff3ff;
			float: left;
			clear: none;
			height: 50px;
			width: 100%;
		}

        #map {
            height: 100%;
            width: 100%;
        }

	</style>

	<title>WebGIS Assignment 4</title>
	<meta name="description" content="Write some words to describe your html page">

	<script>
		let leftPctg = 5, midPctg = 90, rightPctg = 5;
		// $(".test").hide() -- hides all elements with class="test"
		let reAlighDIVs = () => {
			let midHeight = window.innerHeight - $(".pageHeader").height() - $(".pageFooter").height();
			$(".pageContent").height(midHeight).width(midPctg+"%");
			$(".pageLeftMenu").height(midHeight).width(leftPctg+"%");
			$(".pageRightMenu").height(midHeight).width(rightPctg+"%");

            $(".pageLeftMenu").resizable("instance").option("maxWidth", $(".pageHeader").prop("clientWidth")*.45);
			$(".pageRightMenu").resizable("instance").option("maxWidth", $(".pageHeader").prop("clientWidth")*.45);
		}

		$(function () { // Document ready event
			
			
			$(".pageLeftMenu").resizable({
				animate: false,
				handles: "e",
                maxWidth: $(".pageHeader").prop("clientWidth")*.45,
				resize: function (event, ui) { // Event triggered by the resize on the drag of the resize handler
					$(window).off('resize');

					let rightWidth = $(".pageRightMenu").outerWidth(true);
					let midWidth = $(".pageHeader").prop("clientWidth") - $(".pageLeftMenu").outerWidth(true) - rightWidth;
					$(".pageContent").innerWidth(midWidth-1);
					$(".pageRightMenu").width(rightWidth);
				},
				stop: function (event, ui) { // Event triggered by the resize on the drag of the resize handler
                    let totWidth =  $(".pageHeader").prop("clientWidth");
					    rightWidth = $(".pageRightMenu").outerWidth(true);
                        leftWidth = $(".pageLeftMenu").outerWidth(true);
					    midWidth = totWidth - leftWidth - rightWidth;

                    	leftPctg = Math.round(100.0*leftWidth/totWidth),
                        midPctg =  Math.round(100.0*midWidth/totWidth),
                        rightPctg = 100 - leftPctg - midPctg;

					$(".pageContent").innerWidth(midPctg + "%");
                    $(".pageLeftMenu").width(leftPctg + "%")
					$(".pageRightMenu").width(rightPctg + "%");
					
					$(window).resize(reAlighDIVs);
				}
			});

			$(".pageRightMenu").resizable({	
				animate: false,	
				handles: "w",
                maxWidth: $(".pageHeader").prop("clientWidth")*.45,
				resize: function (event, ui) { // Event triggered by the resize on the drag of the resize handler
					$(window).off('resize');

					rightWidth = $(".pageRightMenu").outerWidth(true);
					midWidth = $(".pageHeader").prop("clientWidth") - $(".pageLeftMenu").outerWidth(true) - rightWidth;
					$(".pageContent").innerWidth(midWidth-1);
					$(".pageRightMenu").width(rightWidth);

				},
				stop: function (event, ui) { // Event triggered by the resize on the drag of the resize handler
                    let totWidth =  $(".pageHeader").prop("clientWidth");
					    rightWidth = $(".pageRightMenu").outerWidth(true);
                        leftWidth = $(".pageLeftMenu").outerWidth(true);
					    midWidth = totWidth - leftWidth - rightWidth;


					rightPctg = Math.round(100.0*rightWidth/totWidth),
					midPctg =  Math.round(100.0*midWidth/totWidth),
					leftPctg = 100 - rightPctg - midPctg;

					$(".pageContent").innerWidth(midPctg + "%");
                    $(".pageLeftMenu").width(leftPctg + "%")
					$(".pageRightMenu").width(rightPctg + "%");
					
					$(window).resize(reAlighDIVs);
				}
			});
            $(document).ready(reAlighDIVs);
		    $(window).resize(reAlighDIVs);
		});
	</script>
</head>

<body>
	<div class="blended_grid">
		<div class="pageHeader">
            
            <div>Andrew Kittredge<br>
            GTECH 78534<br>
            Assignment 4</div>
            <div>Manhattan Population by Census Tract</div>
            
		</div>
		<div class="pageLeftMenu">
		</div>
		<div class="pageContent">
            <div id="map"></div>
		</div>
		<div class="pageRightMenu">
		</div>
		<div class="pageFooter">
		</div>
	</div>
</body>

<script>
    var map = L.map('map').setView([40.785, -73.9675], 12);

            var baseLayer = L.tileLayer(
                "https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoiYXBrNTAwMCIsImEiOiJjbGZuODRja2QwajZpM3FxenM3YzVqZXl3In0.h2lhBTPGo_jm_4cdaTxPog",
                {
                    maxZoom: 19,
                    attribution:
                        'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, ' +
                        '<a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
                        'Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
                    id: "mapbox/light-v9",
                    tileSize: 512,
                    zoomOffset: -1,
                }
            ).addTo(map);

            var nyBlockLayer = L.geoJson(nyBlockLayer, {style: style}).bindTooltip(l => {
                return "Census " + l.feature.properties.name.toLowerCase() + " has <strong>" + l.feature.properties.TotalPop + "</strong> residents.";
                }
            );

            $.getJSON("./ny_ny_block_pop.geojson", function (data) {
                nyBlockLayer.addData(data);
            });

            nyBlockLayer.addTo(map);
            
            function getColor(d) {
                return  d > 1000 ? '#08519c' :
                        d > 500 ? '#3182bd' :
                        d > 100 ? '#6baed6' :
                        d > 50 ? '#9ecae1' :
                        d > 10 ? '#c6dbef' :
                                    '#eff3ff';
            }

            function getFillOpacity(d) {
                if (d > 0){
                    return 0.7
                } else {
                    return 0
                }
            }

            function style(feature) {
                return {
                    fillColor: getColor(feature.properties.TotalPop),
                    weight: 0.2,
                    opacity: 0.7,
                    color: "white",
                    dashArray: '3',
                    fillOpacity: getFillOpacity(feature.properties.TotalPop)
                }
            }
	

</script>

</html>